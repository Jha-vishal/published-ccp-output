(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{2089:function(e,t,n){Promise.resolve().then(n.bind(n,2257))},2257:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return f}});var s=n(7437),a=n(2265),o=()=>{(0,a.useEffect)(()=>(window.addEventListener("beforeunload",e),window.addEventListener("unload",t),()=>{window.removeEventListener("beforeunload",e),window.removeEventListener("unload",t)}),[]);let e=e=>{let t="Are you sure you want to logout?";return e.returnValue=t,t},t=()=>{confirm("Are you sure you want to logout?")&&fetch("https://qcw5zjy0pi.execute-api.us-west-2.amazonaws.com/dev/mycompany-dev-setagentLogOut",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({InstanceId:"373e6abb-640e-47b2-908a-87da4cab3acb",AgentStatusId:"STRING_VALUE",Name:"",Description:"STRING_VALUE",State:"ENABLED",DisplayOrder:1,ResetOrderNumber:!1})}).then(e=>{if(!e.ok)throw Error("Network response was not ok");return e.json()}).then(e=>{alert("Logged out successfully!")}).catch(e=>{console.error("Error logging out:",e),alert("Failed to logout. Please try again.")})},n=()=>new Promise((e,t)=>{let n=new connect.Agent,s=n.getAgentStates().find(e=>e.type===connect.AgentStateType.OFFLINE);s?n.setState(s,{success:()=>e(),failure:e=>t(e)},{enqueueNextState:!0}):t(Error("Offline state not found"))}),o=()=>{fetch("https://mycompanydev.my.connect.aws/logout",{credentials:"include",mode:"no-cors"}).then(()=>{connect.core.terminate();let e=document.getElementById("ccpContainer");e&&(e.innerHTML=""),confirm("CCP has been disconnected. Now You can close the browser tab or window.")&&window.close()})};return(0,s.jsx)("nav",{className:"navbar navbar-light",children:(0,s.jsxs)("div",{className:"container-fluid",children:[(0,s.jsx)("span",{className:"navbar-brand h1",children:(0,s.jsx)("b",{children:"mycompany E911 CCP (Contact Center Panel)"})}),(0,s.jsx)("button",{className:"btn btn-danger btn-lg",onClick:()=>{confirm("Are you sure you want to logout?")&&(new connect.Agent().getState().type===connect.AgentStateType.OFFLINE?o():n().then(o).catch(console.error))},children:(0,s.jsx)("b",{children:"Logout"})})]})})},l=e=>{let{onToggle:t,isVisible:n}=e;return(0,s.jsx)("div",{className:"news-container",children:(0,s.jsxs)("div",{className:"news-content",children:[(0,s.jsxs)("div",{className:"switch-holder",children:[(0,s.jsx)("div",{className:"switch-label",children:(0,s.jsx)("span",{children:"Click here for E-911 Info"})}),(0,s.jsxs)("div",{className:"switch-toggle",children:[(0,s.jsx)("input",{type:"checkbox",id:"e911Toggle",checked:n,onChange:t}),(0,s.jsx)("label",{htmlFor:"e911Toggle"})]})]}),(0,s.jsx)("div",{className:"news-banner",children:(0,s.jsxs)("marquee",{behavior:"scroll",direction:"left",children:[(0,s.jsx)("b",{children:"Important:"})," To ensure your session ends correctly and prevent potential login issues or unauthorized access, always use the Logout button instead of closing the browser or tab directly."]})})]})})};let c=window.connect?window.connect:{core:{initCCP:(e,t)=>{console.log("Mock CCP initialized with config:",t)},getEventBus:()=>({trigger:e=>{console.log("Event triggered: ".concat(e))}})},agent:e=>{e({getConfiguration:()=>({username:"mock-agent@example.com",instanceId:"mock-instance-id"}),getStatus:()=>({statusId:"mock-status-id"}),getState:()=>({type:"ROUTABLE"}),getAgentStates:()=>[{type:"OFFLINE",name:"Offline"},{type:"AVAILABLE",name:"Available"}],setState:(e,t)=>{console.log("Agent state changed:",e),t.success()},onRefresh:e=>e()})},contact:e=>{e({onConnecting:e=>e(),onConnected:e=>e(),onEnded:e=>e(),onDestroy:e=>e(),getAttributes:()=>({serviceRequestNumber:{value:"12345"},subStatus:{value:"In Progress"},loginType:{value:"Admin"}}),contactId:"mock-contact-id"})},AgentStatusType:{OFFLINE:"OFFLINE"},AgentStateType:{OFFLINE:"OFFLINE"},EventType:{TERMINATE:"TERMINATE"},agentApp:{initApp:(e,t,n)=>{console.log("Mock agentApp.initApp called with: ".concat(e,", ").concat(t,", ").concat(n))}}};var r=()=>{let[e,t]=(0,a.useState)(!0);(0,a.useEffect)(()=>{let e=null;(()=>{let t=document.getElementById("ccpContainer");if(t){var s;let a="https://".concat("mycompany",".my.connect.aws/ccp-v2/");try{c.core.initCCP(t,{ccpUrl:a,loginPopup:!0,loginPopupAutoClose:!0,loginOptions:{autoClose:!0,height:600,width:400,top:0,left:0},region:"us-east-1",softphone:{allowFramedSoftphone:!0,disableRingtone:!1},pageOptions:{enableAudioDeviceSettings:!0,enablePhoneTypeSettings:!0}})}catch(e){console.error("Error initializing CCP:",e)}c.agent(e=>{let t=e.getConfiguration().username;["agent_username","agent_username1","agentUserName"].forEach(e=>{let n=document.getElementById(e);n&&(n.value=t)})}),window.addEventListener("beforeunload",function(e){console.log("State updated"),fetch("https://mycompanydev.my.connect.aws/connect/logout",{credentials:"include",mode:"no-cors"}).then(()=>{c.core.getEventBus().trigger(c.EventType.TERMINATE)}),fetch("https://mycompanydev.my.connect.aws/logout",{credentials:"include",mode:"no-cors"}).then(()=>{c.core.getEventBus().trigger(c.EventType.TERMINATE)}),e.returnValue="Are you sure you want to leave?"}),c.agentApp.initApp("ccp","container-div",a),c.contact(e=>{e.onConnecting(()=>{let t=e.contactId,n=e.getAttributes(),s=document.getElementById("ccpId");if(s&&(s.value=t),n.serviceRequestNumber){let e=document.getElementById("ccp-details");e&&(e.style.display="block",e.innerHTML="Service Req No: ".concat(n.serviceRequestNumber.value))}if(n.subStatus){let e=document.getElementById("ccp-details1");e&&(e.style.display="block",e.innerHTML="SR sub Status: ".concat(n.subStatus.value))}if(n.loginType){let e=document.getElementById("ccp-details2");e&&(e.style.display="block",e.innerHTML="SR opted Type: ".concat(n.loginType.value))}}),e.onDestroy(()=>{let e=document.getElementById("btnStart");e&&(e.innerHTML="Start");let t=document.getElementById("btnStop");t&&(t.innerHTML="Stop");let n=document.getElementById("btnResume");n&&(n.innerHTML="Resume");let s=document.getElementById("btnPause");s&&(s.innerHTML="Pause");let a=document.getElementById("ccp-details1");a&&(a.style.display="none");let o=document.getElementById("ccp-details2");o&&(o.style.display="none");let l=document.getElementById("ccp-details");l&&(l.style.display="none");let c=document.getElementById("ccp-detail");c&&(c.style.display="none");let r=document.getElementById("ccpId");r&&(r.style.display="none")})}),c.agent(e=>{}),c.contact(function(t){t.onConnecting(e=>{console.log("Inside onConnecting");let t=null==e?void 0:e.contactId;if(t){let e=document.getElementById("ccpId");e&&(e.value=t)}else console.error("Contact or contactId is undefined");if("function"==typeof(null==e?void 0:e.getAttributes)){let n=e.getAttributes();if(console.log("connect attributes is ",JSON.stringify(n)),"serviceRequestNumber"in n){console.log("service request number is ",n.serviceRequestNumber.value);let e=n.serviceRequestNumber.value,t=document.getElementById("ccp-details");t&&(t.style.display="block",t.innerHTML="Service Req No: "+e)}if("subStatus"in n){console.log("subStatus is ",n.subStatus.value);let e=n.subStatus.value,t=document.getElementById("ccp-details1");t&&(t.style.display="block",t.innerHTML="SR sub Status: "+e)}if("loginType"in n){console.log("SR Type is ",n.loginType.value);let e=n.loginType.value,t=document.getElementById("ccp-details2");t&&(t.style.display="block",t.innerHTML="SR opted Type: "+e)}console.log(t)}}),t.onDestroy(()=>{let e=document.getElementById("btnStart"),t=document.getElementById("btnStop"),n=document.getElementById("btnResume"),s=document.getElementById("btnPause"),a=document.getElementById("ccp-details1"),o=document.getElementById("ccp-details2"),l=document.getElementById("ccp-details"),c=document.getElementById("ccp-detail"),r=document.getElementById("ccpId");e&&(e.innerHTML="Start"),t&&(t.innerHTML="Stop"),n&&(n.innerHTML="Resume"),s&&(s.innerHTML="Pause"),a&&(a.style.display="none"),o&&(o.style.display="none"),l&&(l.style.display="none"),c&&(c.style.display="none"),r&&(r.style.display="none")}),t.onConnected(t=>{(function(t){let n=document.getElementById("transcriptionContainer");n&&(n.innerHTML=""),(e=new WebSocket("wss://transcription-websocket-url")).onmessage=function(e){let t=JSON.parse(e.data).Transcript,s=document.createElement("p");s.textContent=t,n&&n.appendChild(s)},e.onopen=function(){console.log("Transcription stream opened")},e.onclose=function(){console.log("Transcription stream closed")},e.onerror=function(e){console.error("Transcription stream error:",e)}})(0)}),t.onEnded(t=>{e&&(e.close(),e=null)})}),c.agent(e=>{e.onRefresh(n)}),null===(s=c.agentApp)||void 0===s||s.initApp("ccp","container-div",a)}else console.error("CCP container not found or instance alias not set")})();let t=e=>{e.preventDefault(),e.returnValue="Are you sure you want to leave?"};return window.addEventListener("beforeunload",t),()=>{window.removeEventListener("beforeunload",t)}},[]);let n=e=>{let t=null==e?void 0:e.getConfiguration().username;["agent_username","agent_username1","agentUserName"].forEach(e=>{let n=document.getElementById(e);n&&(n.value=t)})};return(0,s.jsxs)("div",{className:"ccp-container",style:{position:"relative"},children:[(0,s.jsx)("div",{style:{position:"absolute",top:10,right:10,zIndex:2},children:(0,s.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:8},children:[(0,s.jsx)("input",{type:"checkbox",checked:e,onChange:()=>t(e=>!e),style:{marginRight:4}}),"Show CCP Mockup (This is for demo purposes only)"]})}),e?(0,s.jsx)("img",{src:"./mockup/ccp-mockup.png",alt:"CCP Mockup",style:{width:"100%",height:"100%",objectFit:"contain",borderRadius:8}}):(0,s.jsx)("div",{id:"ccpContainer",style:{width:"100%",height:"100%"}})]})},i=()=>{let[e,t]=(0,a.useState)({agentUserName:"",agentPhone:"",houseNumber:"",street:"",city:"",state:"",postalCode:"",country:"USA"});(0,a.useEffect)(()=>{t(e=>({...e,agentUserName:"mock-agent@example.com"}))},[]);let n=e=>{let{name:n,value:s}=e.target;t(e=>({...e,[n]:s}))};return(0,s.jsxs)("div",{className:"card h-100",children:[(0,s.jsx)("div",{className:"card-header",children:(0,s.jsx)("h5",{className:"mb-0",children:"Address Validation"})}),(0,s.jsx)("div",{className:"card-body overflow-auto",children:(0,s.jsx)("form",{children:Object.entries(e).map(e=>{let[t,a]=e;return(0,s.jsxs)("div",{className:"form-group row mb-2",children:[(0,s.jsx)("label",{htmlFor:t,className:"col-sm-6 col-form-label",children:"agentUserName"===t?"Agent User Name":"agentPhone"===t?"Agent Phone Number":t.charAt(0).toUpperCase()+t.slice(1).replace(/([A-Z])/g," $1").trim()}),(0,s.jsx)("div",{className:"col-sm-6 col-input",children:(0,s.jsx)("input",{type:"agentPhone"===t?"tel":"text",className:"form-control",id:t,name:t,value:a,onChange:n,readOnly:"agentUserName"===t||"country"===t,placeholder:"agentPhone"===t?"+18001234567":"-"})})]},t)})})})]})},d=()=>(0,s.jsxs)("div",{className:"card h-100",children:[(0,s.jsx)("div",{className:"card-header",children:(0,s.jsx)("h5",{className:"mb-0",children:"System Validated Address"})}),(0,s.jsx)("div",{className:"card-body overflow-auto",children:(0,s.jsx)("form",{children:[{key:"road",label:"Road or Street (RD)"},{key:"streetSuffix",label:"Street Suffix (STS)"},{key:"leadingDirection",label:"Leading Street Direction (PRD)"},{key:"houseNumber",label:"House Number (HNO)"},{key:"houseNumberSuffix",label:"House Number Suffix (HNS)"},{key:"city",label:"City (A3)"},{key:"state",label:"State (A1)"},{key:"postalCode",label:"Postal Code (PC)"},{key:"trailingSuffix",label:"Trailing street suffix (POD)"},{key:"locationInfo",label:"Additional Location Info (LOC)"},{key:"residenceName",label:"Name of Residence (NAM)"},{key:"country",label:"Country"}].map(e=>(0,s.jsxs)("div",{className:"form-group row mb-2",children:[(0,s.jsx)("label",{htmlFor:e.key,className:"col-sm-6 col-form-label",children:e.label}),(0,s.jsx)("div",{className:"col-sm-6 col-input",children:(0,s.jsx)("input",{type:"text",className:"form-control",id:e.key,name:e.key,readOnly:!0,value:"country"===e.key?"USA":""})})]},e.key))})})]}),u=e=>{let{onApiResponse:t}=e,[n,o]=(0,a.useState)(!1),l=async()=>{o(!0);try{await new Promise(e=>setTimeout(e,1e3)),t(JSON.stringify({success:!0,message:"Address validated and stored successfully"},null,2))}catch(e){t(JSON.stringify({error:"Failed to validate address"},null,2))}finally{o(!1)}},c=async()=>{o(!0);try{await new Promise(e=>setTimeout(e,1e3)),t(JSON.stringify({success:!0,message:"Address retrieved successfully"},null,2))}catch(e){t(JSON.stringify({error:"Failed to retrieve address"},null,2))}finally{o(!1)}};return(0,s.jsxs)("div",{className:"card h-100",children:[(0,s.jsx)("div",{className:"card-header",children:(0,s.jsx)("h5",{className:"mb-0",children:"e911 Address Options"})}),(0,s.jsx)("div",{className:"card-body d-flex flex-column justify-content-center",children:(0,s.jsxs)("div",{className:"e911-options-grid",children:[(0,s.jsx)("div",{className:"e911-option-quadrant",children:(0,s.jsx)("button",{className:"btn btn-primary w-100 h-100",onClick:l,disabled:n,children:n?"Processing...":"Validate and Store Address"})}),(0,s.jsx)("div",{className:"e911-option-quadrant",children:(0,s.jsx)("button",{className:"btn btn-primary w-100 h-100",onClick:()=>{t(JSON.stringify({message:"Input parameters reset"},null,2))},disabled:n,children:"Reset Input Parameters"})}),(0,s.jsx)("div",{className:"e911-option-quadrant",children:(0,s.jsx)("button",{className:"btn btn-primary w-100 h-100",onClick:c,disabled:n,children:n?"Retrieving...":"Retrieve a Stored Address"})}),(0,s.jsx)("div",{className:"e911-option-quadrant",children:(0,s.jsx)("button",{className:"btn btn-primary w-100 h-100",onClick:()=>{t(JSON.stringify({message:"Validated address reset"},null,2))},disabled:n,children:"Reset Validated Address"})})]})})]})},m=e=>{let{response:t}=e;return(0,s.jsxs)("div",{className:"card h-100",children:[(0,s.jsx)("div",{className:"card-header",children:(0,s.jsx)("h5",{className:"mb-0",children:"API Response"})}),(0,s.jsx)("div",{className:"card-body",children:(0,s.jsx)("textarea",{className:"form-control h-100",value:t,readOnly:!0,style:{resize:"none"}})})]})};let g=window.connect?window.connect:{agent:e=>{e({getConfiguration:()=>({username:"mock-agent@example.com"}),getContacts:()=>[{startRecording:e=>{let{success:t}=e;return t()},stopRecording:e=>{let{success:t}=e;return t()},pauseRecording:e=>{let{success:t}=e;return t()},resumeRecording:e=>{let{success:t}=e;return t()}}]})},contact:e=>{e({onConnecting:e=>e(),onConnected:e=>e(),onEnded:e=>e(),contactId:"mock-contact-id"})}};var h=()=>{let[e,t]=(0,a.useState)(!1),[n,o]=(0,a.useState)(!1),[l,c]=(0,a.useState)(""),[r,i]=(0,a.useState)("");return(0,a.useEffect)(()=>{g.contact(e=>{e.onConnecting(()=>{c(e.contactId)}),e.onConnected(()=>{t(!1),o(!1)}),e.onEnded(()=>{t(!1),o(!1),c("")})}),g.agent(e=>{i(e.getConfiguration().username)})},[]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"card-header",children:(0,s.jsx)("h5",{children:"Amazon Connect Call Recording Controls"})}),(0,s.jsxs)("div",{className:"card-body",children:[(0,s.jsx)("form",{id:"recording_form",className:"mb-3",children:(0,s.jsxs)("div",{className:"row",children:[(0,s.jsxs)("div",{className:"col-md-6",children:[(0,s.jsx)("label",{htmlFor:"ccpId",children:"Contact ID"}),(0,s.jsx)("input",{type:"text",className:"form-control",id:"ccpId",value:l,readOnly:!0})]}),(0,s.jsxs)("div",{className:"col-md-6",children:[(0,s.jsx)("label",{htmlFor:"agent_username1",children:"Agent User Name"}),(0,s.jsx)("input",{type:"text",className:"form-control",id:"agent_username1",value:r,readOnly:!0})]})]})}),(0,s.jsxs)("div",{className:"recording-buttons",children:[(0,s.jsx)("button",{type:"button",className:"btn btn-success",onClick:()=>{g.agent(e=>{let n=e.getContacts()[0];n&&n.startRecording({success:()=>{t(!0),o(!1)},failure:e=>console.error("Failed to start recording:",e)})})},disabled:e&&!n,children:e&&!n?"Recording":"Start"}),(0,s.jsx)("button",{type:"button",className:"btn btn-danger",onClick:()=>{g.agent(e=>{let n=e.getContacts()[0];n&&n.stopRecording({success:()=>{t(!1),o(!1)},failure:e=>console.error("Failed to stop recording:",e)})})},disabled:!e,children:"Stop"}),(0,s.jsx)("button",{type:"button",className:"btn btn-secondary",onClick:()=>{g.agent(e=>{let t=e.getContacts()[0];t&&t.pauseRecording({success:()=>o(!0),failure:e=>console.error("Failed to pause recording:",e)})})},disabled:!e||n,children:n?"Paused":"Pause"}),(0,s.jsx)("button",{type:"button",className:"btn btn-info",onClick:()=>{g.agent(e=>{let t=e.getContacts()[0];t&&t.resumeRecording({success:()=>o(!1),failure:e=>console.error("Failed to resume recording:",e)})})},disabled:!n,children:"Resume"})]})]})]})},p=()=>{let[e,t]=(0,a.useState)(""),[n,o]=(0,a.useState)(!1),[l,c]=(0,a.useState)(null),[r,i]=(0,a.useState)("");(0,a.useEffect)(()=>{i("mock-agent@example.com")},[]);let d=async()=>{o(!0),c(null);try{let n=await fetch("/api/insertOutOfOfficeMessage",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:e,agentUsername:r})}),s=await n.json();if(s.success)t(""),alert("Out-of-office message stored successfully");else throw Error(s.error||"Failed to store out-of-office message")}catch(e){console.error("Error inserting out-of-office message:",e),c(e.message)}finally{o(!1)}};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"card-header text-center",children:(0,s.jsx)("h5",{children:(0,s.jsx)("b",{children:"Out of Office Message"})})}),(0,s.jsxs)("div",{className:"card-body",children:[(0,s.jsxs)("form",{id:"ooo",className:"needs-validation",noValidate:!0,children:[(0,s.jsxs)("div",{className:"row",children:[(0,s.jsxs)("div",{className:"col-md-6",children:[(0,s.jsx)("label",{htmlFor:"agent_username",children:"Agent User Name"}),(0,s.jsx)("input",{type:"text",className:"form-control",id:"agent_username",value:r,readOnly:!0})]}),(0,s.jsxs)("div",{className:"col-md-6",children:[(0,s.jsx)("label",{htmlFor:"agent_msg",children:"Agent Message"}),(0,s.jsx)("input",{type:"text",className:"form-control",id:"agent_msg",value:e,onChange:e=>t(e.target.value)})]})]}),(0,s.jsx)("button",{className:"btn btn-outline-primary mt-3",type:"button",onClick:d,disabled:n,children:n?"Submitting...":"Submit"})]}),l&&(0,s.jsx)("div",{className:"alert alert-danger mt-3",children:l})]})]})},y=()=>(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"card-header text-center",children:(0,s.jsx)("h5",{children:(0,s.jsx)("b",{children:"Real-time Call Transcription"})})}),(0,s.jsx)("div",{className:"card-body text-center",children:(0,s.jsx)("p",{children:"This is an upcoming feature that will be launched soon."})})]}),b=()=>(0,s.jsxs)("div",{className:"additional-cards",children:[(0,s.jsxs)("div",{className:"row mb-3",children:[(0,s.jsx)("div",{className:"col-md-6",children:(0,s.jsx)("div",{className:"card h-100",children:(0,s.jsx)(h,{})})}),(0,s.jsx)("div",{className:"col-md-6",children:(0,s.jsx)("div",{className:"card h-100",children:(0,s.jsx)(p,{})})})]}),(0,s.jsx)("div",{className:"row",children:(0,s.jsx)("div",{className:"col-12",children:(0,s.jsx)("div",{className:"card",children:(0,s.jsx)(y,{})})})})]});function f(){let[e,t]=(0,a.useState)(!1),[n,c]=(0,a.useState)("");return(0,a.useEffect)(()=>{t("true"===localStorage.getItem("e911Visible"))},[]),(0,s.jsxs)("main",{className:"app-container",children:[(0,s.jsx)(o,{}),(0,s.jsxs)("div",{className:"main-content",children:[(0,s.jsx)(r,{}),(0,s.jsxs)("div",{className:"right-side",children:[(0,s.jsx)(l,{onToggle:()=>{let n=!e;t(n),localStorage.setItem("e911Visible",n.toString())},isVisible:e}),(0,s.jsx)("div",{className:"right-container",children:e?(0,s.jsx)(b,{}):(0,s.jsxs)("div",{className:"quadrant-container",children:[(0,s.jsx)("div",{className:"quadrant quadrant-address-validation",children:(0,s.jsx)(i,{})}),(0,s.jsx)("div",{className:"quadrant quadrant-validated-address",children:(0,s.jsx)(d,{})}),(0,s.jsx)("div",{className:"quadrant quadrant-e911-options",children:(0,s.jsx)(u,{onApiResponse:e=>{c(e)}})}),(0,s.jsx)("div",{className:"quadrant quadrant-api-response",children:(0,s.jsx)(m,{response:n})})]})})]})]})]})}}},function(e){e.O(0,[971,117,744],function(){return e(e.s=2089)}),_N_E=e.O()}]);